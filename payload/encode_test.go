package payload_test

import (
	"testing"

	"github.com/vulncheck-oss/go-exploit/payload"
)

func TestEncodeCommandBrace(t *testing.T) {
	encoded := payload.EncodeCommandBrace("foo bar baz")

	if encoded != "{foo,bar,baz}" {
		t.Fatal(encoded)
	}

	t.Log(encoded)
}

func TestEncodeCommandIFS(t *testing.T) {
	encoded := payload.EncodeCommandIFS("foo bar baz")

	if encoded != "foo${IFS}bar${IFS}baz" {
		t.Fatal(encoded)
	}

	t.Log(encoded)
}

func TestEncodeEchoBase64ToBash(t *testing.T) {
	encoded := payload.EncodeEchoBase64ToBash("whoami; id;")

	if encoded != "echo d2hvYW1pOyBpZDs=|base64 -d|bash" {
		t.Fatal(encoded)
	}

	t.Log(encoded)
}
