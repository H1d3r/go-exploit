package payload

import (
	"regexp"
)

func EncodeCommandBrace(cmd string) string {
	escaped := regexp.MustCompile(`([{,}])`).ReplaceAllString(cmd, `\$1`)

	return "{" + regexp.MustCompile(`\s+`).ReplaceAllString(escaped, ",") + "}"
}

func EncodeCommandIFS(cmd string) string {
	return regexp.MustCompile(`\s+`).ReplaceAllLiteralString(cmd, "${IFS}")
}
