package payload

import (
	b64 "encoding/base64"
	"fmt"
)

// Base64 encodes the command. Wraps it in logic to base64 decode and pipe to bash.
func Base64EncodeForBash(cmd string) string {
	cmd64 := b64.StdEncoding.EncodeToString([]byte(cmd))

	return fmt.Sprintf("echo %s|base64 -d|bash", cmd64)
}

// Base64 encodes the command. Wraps it in logic to base64 decode and evaluate it in Groovy.
func Base64EncodeForGroovyEval(cmd string) string {
	cmd64 := b64.StdEncoding.EncodeToString([]byte(cmd))

	return fmt.Sprintf("Eval.me(new String('%s'.decodeBase64()))", cmd64)
}

// Base64 encodes the command. Wraps it in logic to base64 decode and evaluate it in PHP.
func Base64EncodeForPHPEval(cmd string) string {
	cmd64 := b64.StdEncoding.EncodeToString([]byte(cmd))

	return fmt.Sprintf(`<?php eval(base64_decode("%s")); ?>`, cmd64)
}
